Version 4
SHEET 1 4016 1428
WIRE 208 -672 80 -672
WIRE 496 -672 384 -672
WIRE 816 -672 704 -672
WIRE 80 -640 80 -672
WIRE 384 -640 384 -672
WIRE 704 -640 704 -672
WIRE 80 -528 80 -560
WIRE 384 -528 384 -560
WIRE 704 -528 704 -560
WIRE 464 -176 -16 -176
WIRE 656 -176 544 -176
WIRE 832 -176 656 -176
WIRE 1120 -176 928 -176
WIRE 1280 -176 1120 -176
WIRE 832 -144 800 -144
WIRE 976 -144 928 -144
WIRE 1120 -128 1120 -176
WIRE 800 -64 800 -144
WIRE 976 -64 976 -144
WIRE -128 -48 -272 -48
WIRE -16 -48 -16 -176
WIRE -16 -48 -64 -48
WIRE 176 -16 144 -16
WIRE 416 -16 176 -16
WIRE 528 -16 480 -16
WIRE 544 -16 528 -16
WIRE 1120 -16 1120 -48
WIRE -272 0 -272 -48
WIRE -272 32 -272 0
WIRE -128 32 -160 32
WIRE -16 32 -16 -48
WIRE -16 32 -64 32
WIRE -16 112 -16 32
WIRE 0 112 -16 112
WIRE 144 112 144 -16
WIRE 144 112 80 112
WIRE 208 112 144 112
WIRE 320 112 288 112
WIRE 384 112 320 112
WIRE 496 112 464 112
WIRE 560 112 496 112
WIRE 672 112 640 112
WIRE 736 112 672 112
WIRE 848 112 816 112
WIRE 912 112 848 112
WIRE 1024 112 992 112
WIRE 1088 112 1024 112
WIRE 1200 112 1168 112
WIRE 1264 112 1200 112
WIRE 1376 112 1344 112
WIRE 1472 112 1376 112
WIRE 1584 112 1552 112
WIRE 1648 112 1584 112
WIRE 1760 112 1728 112
WIRE 1824 112 1760 112
WIRE 1936 112 1904 112
WIRE 2048 112 1936 112
WIRE 144 128 144 112
WIRE 320 128 320 112
WIRE 496 128 496 112
WIRE 672 128 672 112
WIRE 848 128 848 112
WIRE 1024 128 1024 112
WIRE 1200 128 1200 112
WIRE 1376 128 1376 112
WIRE 1584 128 1584 112
WIRE 1760 128 1760 112
WIRE 1936 128 1936 112
WIRE -272 144 -272 112
WIRE 48 208 32 208
WIRE 144 208 144 192
WIRE 144 208 128 208
WIRE 320 224 320 192
WIRE 496 224 496 192
WIRE 672 224 672 192
WIRE 848 224 848 192
WIRE 1024 224 1024 192
WIRE 1200 224 1200 192
WIRE 1376 224 1376 192
WIRE 1584 224 1584 192
WIRE 1760 224 1760 192
WIRE 1936 224 1936 192
WIRE -160 256 -160 32
WIRE 32 256 32 208
WIRE -160 304 -160 256
WIRE 2048 304 2048 112
WIRE 2048 304 144 304
WIRE -160 416 -160 384
WIRE 144 416 144 304
WIRE 160 416 144 416
WIRE 272 416 240 416
WIRE 336 416 272 416
WIRE 448 416 416 416
WIRE 512 416 448 416
WIRE 624 416 592 416
WIRE 688 416 624 416
WIRE 800 416 768 416
WIRE 848 416 800 416
WIRE 960 416 928 416
WIRE 1024 416 960 416
WIRE 1136 416 1104 416
WIRE 1200 416 1136 416
WIRE 1312 416 1280 416
WIRE 1376 416 1312 416
WIRE 1488 416 1456 416
WIRE 1552 416 1488 416
WIRE 1664 416 1632 416
WIRE 1712 416 1664 416
WIRE 1824 416 1792 416
WIRE 2032 416 1824 416
WIRE 2096 416 2032 416
WIRE 272 432 272 416
WIRE 448 432 448 416
WIRE 624 432 624 416
WIRE 800 432 800 416
WIRE 960 432 960 416
WIRE 1136 432 1136 416
WIRE 1312 432 1312 416
WIRE 1488 432 1488 416
WIRE 1664 432 1664 416
WIRE 1824 432 1824 416
WIRE 272 528 272 496
WIRE 448 528 448 496
WIRE 624 528 624 496
WIRE 800 528 800 496
WIRE 960 528 960 496
WIRE 1136 528 1136 496
WIRE 1312 528 1312 496
WIRE 1488 528 1488 496
WIRE 1664 528 1664 496
WIRE 1824 544 1824 496
WIRE 1840 544 1824 544
WIRE 1936 544 1920 544
WIRE 2032 576 2032 416
WIRE 1936 592 1936 544
WIRE 2032 688 2032 656
FLAG -160 416 0
FLAG 32 256 0
FLAG 320 224 0
FLAG 496 224 0
FLAG 672 224 0
FLAG 848 224 0
FLAG 1024 224 0
FLAG 1200 224 0
FLAG 1376 224 0
FLAG 2032 688 0
FLAG 1584 224 0
FLAG 1760 224 0
FLAG 1936 224 0
FLAG 272 528 0
FLAG 448 528 0
FLAG 624 528 0
FLAG 800 528 0
FLAG 176 -16 Vnear_lumped
FLAG 2096 416 Vfar_lumped
FLAG -160 256 Vdrive
FLAG 800 -64 0
FLAG 976 -64 0
FLAG 1120 -16 0
FLAG 656 -176 Vnear_ideal
FLAG 1280 -176 Vfar_ideal
FLAG 960 528 0
FLAG 1136 528 0
FLAG 1312 528 0
FLAG 1488 528 0
FLAG 1664 528 0
FLAG 1936 592 0
FLAG 528 -16 a
FLAG -272 144 0
FLAG -272 0 b
FLAG 80 -528 0
FLAG 384 -528 0
FLAG 208 -672 calc_z
FLAG 496 -672 calc_delay
FLAG 704 -528 0
FLAG 816 -672 calc_capac
DATAFLAG 400 -672 ""
DATAFLAG 80 -672 ""
DATAFLAG 720 -672 ""
SYMBOL cap 128 128 R0
SYMATTR InstName C1
SYMATTR Value {capac/2}
SYMATTR SpiceLine Rser={esrc}
SYMBOL voltage -160 288 R0
WINDOW 123 24 124 Left 2
WINDOW 39 0 0 Left 0
WINDOW 3 -58 -47 VRight 2
SYMATTR Value2 AC 1
SYMATTR Value PULSE(0 1 0 100n 100n 1m 2m)
SYMATTR InstName V1
SYMBOL ind 192 128 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value {ind}
SYMATTR SpiceLine Rser={esrl}
SYMBOL cap 304 128 R0
SYMATTR InstName C2
SYMATTR Value {capac}
SYMATTR SpiceLine Rser={esrc}
SYMBOL ind 368 128 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L2
SYMATTR Value {ind}
SYMATTR SpiceLine Rser={esrl}
SYMBOL cap 480 128 R0
SYMATTR InstName C3
SYMATTR Value {capac}
SYMATTR SpiceLine Rser={esrc}
SYMBOL ind 544 128 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L3
SYMATTR Value {ind}
SYMATTR SpiceLine Rser={esrl}
SYMBOL cap 656 128 R0
SYMATTR InstName C4
SYMATTR Value {capac}
SYMATTR SpiceLine Rser={esrc}
SYMBOL ind 720 128 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L4
SYMATTR Value {ind}
SYMATTR SpiceLine Rser={esrl}
SYMBOL cap 832 128 R0
SYMATTR InstName C5
SYMATTR Value {capac}
SYMATTR SpiceLine Rser={esrc}
SYMBOL ind 896 128 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L5
SYMATTR Value {ind}
SYMATTR SpiceLine Rser={esrl}
SYMBOL cap 1008 128 R0
SYMATTR InstName C6
SYMATTR Value {capac}
SYMATTR SpiceLine Rser={esrc}
SYMBOL ind 1072 128 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L6
SYMATTR Value {ind}
SYMATTR SpiceLine Rser={esrl}
SYMBOL cap 1184 128 R0
SYMATTR InstName C7
SYMATTR Value {capac}
SYMATTR SpiceLine Rser={esrc}
SYMBOL ind 1248 128 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L7
SYMATTR Value {ind}
SYMATTR SpiceLine Rser={esrl}
SYMBOL cap 1360 128 R0
SYMATTR InstName C8
SYMATTR Value {capac}
SYMATTR SpiceLine Rser={esrc}
SYMBOL res 96 96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rsource
SYMATTR Value {z}
SYMBOL res 2016 560 R0
SYMATTR InstName Rterm
SYMATTR Value {z*termfactor}
SYMBOL ind 1456 128 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L8
SYMATTR Value {ind}
SYMATTR SpiceLine Rser={esrl}
SYMBOL cap 1568 128 R0
SYMATTR InstName C9
SYMATTR Value {capac}
SYMATTR SpiceLine Rser={esrc}
SYMBOL ind 1632 128 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L9
SYMATTR Value {ind}
SYMATTR SpiceLine Rser={esrl}
SYMBOL cap 1744 128 R0
SYMATTR InstName C10
SYMATTR Value {capac}
SYMATTR SpiceLine Rser={esrc}
SYMBOL ind 1808 128 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L10
SYMATTR Value {ind}
SYMATTR SpiceLine Rser={esrl}
SYMBOL cap 1920 128 R0
SYMATTR InstName C11
SYMATTR Value {capac}
SYMATTR SpiceLine Rser={esrc}
SYMBOL ind 144 432 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L11
SYMATTR Value {ind}
SYMATTR SpiceLine Rser={esrl}
SYMBOL cap 256 432 R0
SYMATTR InstName C12
SYMATTR Value {capac}
SYMATTR SpiceLine Rser={esrc}
SYMBOL ind 320 432 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L12
SYMATTR Value {ind}
SYMATTR SpiceLine Rser={esrl}
SYMBOL cap 432 432 R0
SYMATTR InstName C13
SYMATTR Value {capac}
SYMATTR SpiceLine Rser={esrc}
SYMBOL ind 496 432 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L13
SYMATTR Value {ind}
SYMATTR SpiceLine Rser={esrl}
SYMBOL cap 608 432 R0
SYMATTR InstName C14
SYMATTR Value {capac}
SYMATTR SpiceLine Rser={esrc}
SYMBOL ind 672 432 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L14
SYMATTR Value {ind}
SYMATTR SpiceLine Rser={esrl}
SYMBOL cap 784 432 R0
SYMATTR InstName C15
SYMATTR Value {capac/2}
SYMATTR SpiceLine Rser={esrc}
SYMBOL tline 880 -160 R0
WINDOW 0 -9 55 Bottom 2
WINDOW 3 3 -78 Top 2
SYMATTR InstName T1
SYMATTR Value Td={delay} Z0={z}
SYMBOL res 560 -192 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value {z}
SYMBOL res 1104 -144 R0
SYMATTR InstName R4
SYMATTR Value {z*termfactor}
SYMBOL ind 832 432 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L15
SYMATTR Value {ind}
SYMATTR SpiceLine Rser={esrl}
SYMBOL cap 944 432 R0
SYMATTR InstName C16
SYMATTR Value {capac}
SYMATTR SpiceLine Rser={esrc}
SYMBOL ind 1008 432 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L16
SYMATTR Value {ind}
SYMATTR SpiceLine Rser={esrl}
SYMBOL cap 1120 432 R0
SYMATTR InstName C17
SYMATTR Value {capac}
SYMATTR SpiceLine Rser={esrc}
SYMBOL ind 1184 432 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L17
SYMATTR Value {ind}
SYMATTR SpiceLine Rser={esrl}
SYMBOL cap 1296 432 R0
SYMATTR InstName C18
SYMATTR Value {capac}
SYMATTR SpiceLine Rser={esrc}
SYMBOL ind 1360 432 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L18
SYMATTR Value {ind}
SYMATTR SpiceLine Rser={esrl}
SYMBOL cap 1472 432 R0
SYMATTR InstName C19
SYMATTR Value {capac}
SYMATTR SpiceLine Rser={esrc}
SYMBOL ind 1536 432 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L19
SYMATTR Value {ind}
SYMATTR SpiceLine Rser={esrl}
SYMBOL cap 1648 432 R0
SYMATTR InstName C20
SYMATTR Value {capac}
SYMATTR SpiceLine Rser={esrc}
SYMBOL ind 1696 432 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L20
SYMATTR Value {ind}
SYMATTR SpiceLine Rser={esrl}
SYMBOL cap 1808 432 R0
SYMATTR InstName C21
SYMATTR Value {capac/2}
SYMATTR SpiceLine Rser={esrc}
SYMBOL res 144 192 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value {rend}
SYMBOL res 1824 528 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value {rend}
SYMBOL Misc\\jumper -96 -112 R0
SYMATTR InstName X1
SYMBOL Misc\\jumper 448 -80 R0
SYMATTR InstName X2
SYMBOL voltage -272 16 R0
WINDOW 123 24 124 Left 2
WINDOW 39 0 0 Left 0
WINDOW 3 -58 -47 VRight 2
SYMATTR Value2 AC 1
SYMATTR Value SINE(0 1 {freq})
SYMATTR InstName V2
SYMBOL bv 80 -656 R0
SYMATTR InstName B1
SYMATTR Value V=z
SYMBOL bv 384 -656 R0
SYMATTR InstName B2
SYMATTR Value V=delay
SYMBOL bv 704 -656 R0
SYMATTR InstName B3
SYMATTR Value V=capac
TEXT 1576 -664 Left 2 ;.param delay=669u\n.param ind=100u\n.param termfactor 1Gig\n.param esrl 0.01\n.param esrc 0.01\n.param rend = 1Gig\n \n.param capac=(((delay/20)**2)/ind)\n.param z=(sqrt(ind/capac))\n.meas tran z0 param z\n.meas tran del param delay
TEXT 720 976 Left 2 !.ac dec 100 200 5000\n.param freq=1
TEXT 2112 512 Left 2 ;Divide / multiply rt to\nover / underterminate
TEXT 408 984 Left 2 ;.tran 10m\n.param freq=1
TEXT 1696 -56 Left 2 ;For a lumped element transmission line:\nZ0 = sqrt(L/C)\ndelay per stage = sqrt(LC)
TEXT -272 1040 Left 2 ;Set ONLY one of these to an SPICE\ndirective to select simulation type.\n(Right-click, escape, select comment or SPICE)
TEXT 1672 -1176 Left 4 ;Parameter Setup
TEXT 536 720 Left 4 ;Simulation Setup
TEXT 1496 -1096 Left 2 ;ind, capac are the inductance and capacitance for each stage\ntermfactor - set to unity to perfectly terminate.\n     Set to 1f (one femto) to emulate a shortted far end,\n     Set to 1Gig to emulate an open far end.\nesrl, esrc are the series resistance of the inductors, capacitors, respectively\nz is the calculated characteristic impedance\ndelay is the calculated total delay of the lumped line, with 20 stages\nset rend to 1Gig to make the first and last elements series L, set to 1f for shunt C
TEXT 1040 952 Left 2 ;.meas Aavg avg V(a)\n.meas Bavg avg V(b)\n.meas Are avg (V(a)-Aavg)*cos(360*time*Freq)\n.meas Aim avg -(V(a)-Aavg)*sin(360*time*Freq)\n.meas Bre avg (V(b)-Bavg)*cos(360*time*Freq)\n.meas Bim avg -(V(b)-Bavg)*sin(360*time*Freq)\n.meas GainMag param 20*log10(hypot(Are,Aim)/hypot(Bre,Bim))\n.meas GainPhi param mod(atan2(Aim,Are)-atan2(Bim,Bre)+180,360)-180\n.param t0=0\n.tran 0 {t0+25/freq} {t0}\n.step dec param freq 200 5000 10\n.save V(a) V(b)\n.option plotwinsize=0 numdgt=15
TEXT 416 824 Left 2 ;For trasient,\nConnect driven\nend to V1
TEXT 728 824 Left 2 ;For AC response,\nConnect driven\nend to V2
TEXT 1032 824 Left 2 ;For stepped AC response,\nConnect driven\nend to V2
TEXT 696 -296 Left 4 ;LTspice Tline model
TEXT 672 24 Left 4 ;Lumped Tline model
TEXT 296 -776 Left 2 ;Calculated Parameters\n(BV Units are always volts)
TEXT 2032 -672 Left 2 !.param ind=100u\n.param capac=11.20u\n.param termfactor 1Gig\n.param esrl 0.01\n.param esrc 0.01\n.param rend = 1Gig\n \n.param z=(sqrt(ind/capac))\n.param delay = ( 20 * sqrt( ind * capac))\n.meas tran z0 param z\n.meas tran del param delay
TEXT 2064 -776 Left 2 ;Inputs: Inductance, Capacitance\nOutputs: impedance (z), delay
TEXT 1504 -776 Left 2 ;Inputs: Delay, Inductance\nOutputs: impedance (z), Capacitance
TEXT 176 1272 Left 2 ;.op\n.param freq=1
TEXT 1192 -632 Left 2 ;Set only one of these\nto a SPICE directive
TEXT -400 -176 Left 2 ;Connect:\nV1 for time-domain simulation\nV2 for frequency domain
LINE Normal 1840 912 368 912
LINE Normal 336 1136 -128 1136
LINE Normal 288 1088 336 1136
LINE Normal 288 1184 288 1088
LINE Normal 336 1136 288 1184
LINE Normal 1440 -528 1264 -528
LINE Normal 1392 -576 1440 -528
LINE Normal 1392 -480 1392 -576
LINE Normal 1440 -528 1392 -480
RECTANGLE Normal 992 1360 640 784
RECTANGLE Normal 640 1360 368 784
RECTANGLE Normal 1840 1360 992 784
RECTANGLE Normal 1968 -688 1456 -816
RECTANGLE Normal 2480 -688 1968 -816
RECTANGLE Normal 2480 -368 1968 -688
RECTANGLE Normal 1968 -368 1456 -688
