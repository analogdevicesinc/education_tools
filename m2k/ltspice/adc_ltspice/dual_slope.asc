Version 4
SHEET 1 1876 712
WIRE 256 -496 208 -496
WIRE 592 -496 256 -496
WIRE 864 -496 592 -496
WIRE 256 -336 256 -496
WIRE 0 -288 -48 -288
WIRE 48 -288 0 -288
WIRE 96 -288 48 -288
WIRE 192 -288 176 -288
WIRE 0 -272 0 -288
WIRE 864 -272 864 -496
WIRE -1136 -224 -1136 -272
WIRE -1024 -224 -1024 -272
WIRE 656 -224 592 -224
WIRE 704 -224 656 -224
WIRE 800 -224 784 -224
WIRE 656 -192 656 -224
WIRE 0 -176 0 -192
WIRE -1136 -112 -1136 -144
WIRE -1136 -112 -1280 -112
WIRE -1024 -112 -1024 -144
WIRE -1024 -112 -1136 -112
WIRE -1280 -96 -1280 -112
WIRE 656 -96 656 -112
WIRE -1136 -80 -1136 -112
WIRE -1024 -80 -1024 -112
WIRE 64 -64 -224 -64
WIRE 128 -64 64 -64
WIRE 256 -64 256 -240
WIRE 368 -64 256 -64
WIRE 64 -32 64 -64
WIRE 128 -32 128 -64
WIRE 256 -32 256 -64
WIRE 368 -16 368 -64
WIRE 976 0 592 0
WIRE 976 32 976 0
WIRE -1136 48 -1136 0
WIRE -1024 48 -1024 0
WIRE 0 96 -32 96
WIRE 368 96 368 64
WIRE 368 96 320 96
WIRE 592 112 592 0
WIRE 656 112 592 112
WIRE 784 112 720 112
WIRE 864 112 864 -176
WIRE 928 112 864 112
WIRE 368 128 368 96
WIRE 864 160 864 112
WIRE 656 240 656 208
WIRE -112 256 -160 256
WIRE 64 256 64 224
WIRE 64 256 -112 256
WIRE 128 256 128 224
WIRE 128 256 64 256
WIRE 192 256 192 224
WIRE 256 256 256 224
WIRE 256 256 192 256
WIRE 352 256 256 256
WIRE 432 256 352 256
WIRE 592 256 592 112
WIRE 592 256 512 256
WIRE 624 256 592 256
WIRE 784 272 784 112
WIRE 784 272 688 272
WIRE 864 272 864 240
WIRE 864 272 784 272
WIRE 976 272 976 128
WIRE 976 272 864 272
WIRE 1072 272 976 272
WIRE 1168 272 1072 272
WIRE 624 288 592 288
WIRE -112 320 -112 256
WIRE 592 320 592 288
WIRE 656 336 656 304
WIRE -112 448 -112 400
WIRE -112 544 -112 528
WIRE -64 544 -112 544
WIRE -112 576 -112 544
FLAG 592 320 0
FLAG -1280 -96 0
FLAG -1136 -272 Vp
FLAG -32 96 Vp
FLAG -1136 48 Vm
FLAG 368 128 Vm
FLAG 656 208 Vp
FLAG 656 336 Vm
FLAG 1072 272 Vintegrate
FLAG 0 -176 0
FLAG 48 -288 int_ctl
FLAG -112 576 0
FLAG 656 -96 0
FLAG -1024 -272 Vlogic
FLAG -1024 48 Vref
FLAG -224 -64 Vref
FLAG 352 256 Vswitch
FLAG 656 -224 reset_ctl
FLAG 592 -496 Vlogic
FLAG -160 256 W1
IOPIN -160 256 In
FLAG -48 -288 DIO1
IOPIN -48 -288 In
FLAG 208 -496 DIO0
IOPIN 208 -496 In
FLAG 592 -224 DIO0
IOPIN 592 -224 In
FLAG 1168 272 +1
IOPIN 1168 272 In
FLAG -64 544 -1
IOPIN -64 544 In
SYMBOL Opamps\\LTC1043 160 96 M90
WINDOW 3 -32 64 VLeft 2
SYMATTR InstName U1
SYMBOL Opamps\\OP07 656 208 R0
SYMATTR InstName U2
SYMBOL voltage -1136 -240 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V1
SYMATTR Value 5.0
SYMBOL voltage -1136 -96 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V2
SYMATTR Value 5.0
SYMBOL cap 720 96 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 1µF
SYMBOL res 528 240 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 1Meg
SYMBOL pnp 192 -240 M180
SYMATTR InstName Q2
SYMATTR Value 2N3906
SYMBOL res 352 -32 R0
SYMATTR InstName R3
SYMATTR Value 10k
SYMBOL voltage 0 -288 R0
WINDOW 3 -199 -296 VRight 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PULSE(0 {vl} 101m 1u 1u 200m 600m)
SYMATTR InstName V4
SYMBOL res 192 -304 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 10k
SYMBOL voltage -112 432 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 51 60 Left 2
SYMATTR Value {vin}
SYMATTR InstName V3
SYMBOL voltage -112 304 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 51 57 Left 2
SYMATTR Value SINE(0 7.5 62.5 {td} 0 0)
SYMATTR InstName V6
SYMBOL nmos 928 32 R0
SYMATTR InstName M1
SYMATTR Value 2N7002
SYMBOL res 848 144 R0
SYMATTR InstName R2
SYMATTR Value 100k
SYMBOL pnp 800 -176 M180
SYMATTR InstName Q1
SYMATTR Value 2N3906
SYMBOL res 800 -240 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 10k
SYMBOL VOLTAGE 656 -208 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 -168 -225 VRight 2
SYMATTR Value PULSE({vl} 0 1m 1u 1u 100m 600m)
SYMATTR InstName V8
SYMBOL voltage -1024 -240 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V5
SYMATTR Value {vl}
SYMBOL voltage -1024 -96 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V7
SYMATTR Value 5.0
TEXT 264 424 Left 2 !.tran 1.25 startup
TEXT 912 520 Right 2 !.model my_sw sw(Vt= 0.5 Vh=-.25 Ron=0.01 Roff=100Meg)
TEXT 264 488 Left 2 !.step param vin list 1 2 3 4 5
TEXT 264 456 Left 2 !.step param td list 0m 5m 10m 15m
TEXT 272 384 Left 2 !.param vl 3.3
TEXT 912 -456 Left 2 ;Logic translation is subtle...\nonly have 3.3V GPIO from M2k.\nNote that using Vlogic=5V\nwould turn on the PNP always...
TEXT -256 472 Left 2 ;DC input\nvoltage
TEXT -584 312 Left 2 ;Simulated line noise\n(60Hz in U.S., 50Hz in Europe)\nChange to 62.5 to see effect of NOT\nlanding in a SINC filter null.
TEXT 272 -48 Left 2 ;16
TEXT 320 72 Left 2 ;17
TEXT 272 240 Left 2 ;12
TEXT 200 240 Left 2 ;11
TEXT 136 240 Left 2 ;14
TEXT 72 240 Left 2 ;8
TEXT 72 -48 Left 2 ;7
TEXT 136 -48 Left 2 ;13
TEXT -24 80 Left 2 ;4
TEXT 1040 24 Left 2 ;Use ZVN3310\nfrom parts kit
TEXT -336 -24 Left 2 ;(Vref tied to Vm, -5V)
LINE Normal 256 144 256 176
LINE Normal 64 80 112 96
LINE Normal 96 80 64 80
LINE Normal 80 96 64 80
LINE Normal 64 32 64 64
LINE Normal 64 144 64 176
LINE Normal 112 96 112 128
LINE Normal 256 128 112 128
LINE Normal 256 144 256 128
CIRCLE Normal 80 144 48 112
CIRCLE Normal 80 96 48 64
