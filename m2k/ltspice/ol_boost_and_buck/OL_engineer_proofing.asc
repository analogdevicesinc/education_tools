Version 4
SHEET 1 5968 3712
WIRE 1872 1936 1824 1936
WIRE 1936 1936 1872 1936
WIRE 1312 1984 1264 1984
WIRE 1568 1984 1392 1984
WIRE 1744 1984 1568 1984
WIRE 1824 1984 1824 1936
WIRE 1824 1984 1744 1984
WIRE 2048 1984 1824 1984
WIRE 2208 1984 2112 1984
WIRE 2560 1984 2208 1984
WIRE 2672 1984 2560 1984
WIRE 640 2016 -48 2016
WIRE 2208 2048 2208 1984
WIRE 1264 2064 1264 1984
WIRE -48 2080 -48 2016
WIRE -48 2080 -176 2080
WIRE 64 2080 -48 2080
WIRE 208 2080 160 2080
WIRE 384 2080 304 2080
WIRE 400 2080 384 2080
WIRE 576 2080 480 2080
WIRE 704 2080 576 2080
WIRE 992 2080 704 2080
WIRE 1216 2080 992 2080
WIRE 1744 2080 1744 1984
WIRE -176 2096 -176 2080
WIRE 704 2096 704 2080
WIRE 992 2096 992 2080
WIRE 1216 2128 1200 2128
WIRE 144 2160 144 2128
WIRE 224 2160 224 2128
WIRE 224 2160 144 2160
WIRE 288 2160 224 2160
WIRE 1200 2160 1200 2128
WIRE 1264 2160 1264 2144
WIRE 1264 2160 1200 2160
WIRE 2208 2160 2208 2112
WIRE 704 2176 704 2160
WIRE 1264 2176 1264 2160
WIRE -176 2192 -176 2176
WIRE -48 2192 -48 2080
WIRE 32 2192 -48 2192
WIRE 992 2208 992 2176
WIRE 80 2224 64 2224
WIRE 160 2224 144 2224
WIRE 288 2224 288 2160
WIRE 288 2224 240 2224
WIRE 1056 2224 1040 2224
WIRE 1744 2224 1744 2144
WIRE 2560 2224 2560 1984
WIRE 288 2272 288 2224
WIRE 384 2272 384 2080
WIRE 480 2272 480 2080
WIRE 1104 2272 1040 2272
WIRE 2208 2272 2208 2240
WIRE -176 2288 -288 2288
WIRE -160 2288 -176 2288
WIRE 1104 2288 1104 2272
WIRE -160 2320 -160 2288
WIRE 640 2320 640 2016
WIRE 992 2320 992 2288
WIRE 2560 2320 2560 2304
WIRE 32 2336 32 2192
WIRE 224 2336 32 2336
WIRE 1104 2384 1104 2368
WIRE 640 2416 640 2400
WIRE 640 2416 544 2416
WIRE 736 2416 640 2416
WIRE 1712 2416 1712 2384
WIRE 2016 2416 1936 2416
WIRE 2128 2416 2016 2416
WIRE 2192 2416 2128 2416
WIRE 2256 2416 2192 2416
WIRE -288 2432 -288 2288
WIRE -160 2432 -160 2400
WIRE 224 2432 -160 2432
WIRE 2128 2432 2128 2416
WIRE 2192 2432 2192 2416
WIRE 2256 2432 2256 2416
WIRE -48 2464 -48 2192
WIRE 1936 2480 1936 2416
WIRE -160 2496 -160 2432
WIRE 1136 2496 1088 2496
WIRE 1168 2496 1136 2496
WIRE 224 2528 160 2528
WIRE 1568 2528 1568 1984
WIRE 1712 2528 1712 2496
WIRE 1824 2528 1712 2528
WIRE 2128 2528 2128 2512
WIRE 2128 2528 2048 2528
WIRE 560 2544 544 2544
WIRE 640 2544 624 2544
WIRE -48 2560 -48 2544
WIRE 160 2560 160 2528
WIRE 160 2560 -48 2560
WIRE 1088 2560 1088 2496
WIRE -288 2576 -288 2512
WIRE -160 2592 -160 2576
WIRE -48 2592 -48 2560
WIRE 736 2608 736 2416
WIRE 864 2608 736 2608
WIRE 1024 2608 944 2608
WIRE 224 2624 192 2624
WIRE 2528 2624 2528 2544
WIRE 2544 2624 2528 2624
WIRE 1568 2640 1568 2608
WIRE 1824 2640 1568 2640
WIRE 2128 2640 2128 2528
WIRE 2128 2640 2048 2640
WIRE 2192 2640 2192 2512
WIRE 2192 2640 2128 2640
WIRE 2352 2640 2192 2640
WIRE 2544 2640 2352 2640
WIRE 2640 2640 2608 2640
WIRE 1200 2656 1088 2656
WIRE 1568 2656 1568 2640
WIRE 1568 2656 1280 2656
WIRE 2528 2656 2528 2624
WIRE 2544 2656 2528 2656
WIRE 2480 2672 2448 2672
WIRE 2544 2672 2480 2672
WIRE 2624 2672 2608 2672
WIRE 1568 2688 1568 2656
WIRE 2448 2688 2448 2672
WIRE 2528 2688 2528 2656
WIRE 2544 2688 2528 2688
WIRE -48 2704 -48 2672
WIRE 192 2704 192 2624
WIRE 192 2704 -48 2704
WIRE 384 2704 384 2688
WIRE 2560 2720 2560 2688
WIRE 2256 2736 2256 2512
WIRE 2256 2736 2048 2736
WIRE -48 2752 -48 2704
WIRE 1568 2784 1568 2768
WIRE 2448 2800 2448 2768
WIRE 1984 2816 1984 2800
WIRE 1888 2832 1888 2800
WIRE -48 2864 -48 2832
WIRE 1616 2864 1568 2864
WIRE 1632 2864 1616 2864
WIRE 1568 2880 1568 2864
WIRE 1536 2896 944 2896
WIRE 1984 2896 1984 2880
WIRE 1712 2912 1712 2528
WIRE 1712 2912 1600 2912
WIRE 1536 2928 1472 2928
WIRE 1568 2960 1568 2944
WIRE 1616 3008 1568 3008
WIRE 1632 3008 1616 3008
WIRE 1568 3024 1568 3008
WIRE 1536 3040 1120 3040
WIRE 1712 3056 1712 2912
WIRE 1712 3056 1600 3056
WIRE 1472 3072 1472 2928
WIRE 1536 3072 1472 3072
WIRE 1568 3104 1568 3088
WIRE 1616 3152 1568 3152
WIRE 1632 3152 1616 3152
WIRE 1568 3168 1568 3152
WIRE 1536 3184 1264 3184
WIRE 1712 3200 1712 3056
WIRE 1712 3200 1600 3200
WIRE 1472 3216 1472 3072
WIRE 1536 3216 1472 3216
WIRE 1568 3248 1568 3232
WIRE 944 3296 944 2896
WIRE 1120 3296 1120 3040
WIRE 1264 3296 1264 3184
WIRE 1472 3296 1472 3216
WIRE 944 3408 944 3376
WIRE 1120 3408 1120 3376
WIRE 1264 3408 1264 3376
WIRE 1472 3408 1472 3376
FLAG 2480 2672 clk
FLAG 2560 2720 0
FLAG 2528 2544 Vcc
FLAG -176 2080 IN
FLAG 576 2080 p_prot
FLAG -176 2192 0
FLAG 640 2544 0
FLAG 384 2704 0
FLAG -48 2864 0
FLAG 992 2320 0
FLAG 1104 2384 0
FLAG 1056 2224 0
FLAG 704 2176 0
FLAG 64 2224 0
FLAG 1568 2784 0
FLAG 1888 2832 0
FLAG 1984 2896 0
FLAG -288 2576 0
FLAG -176 2288 USB_PWR
FLAG -160 2592 0
FLAG 1264 2176 0
FLAG 1744 2224 0
FLAG 2448 2800 0
FLAG 2016 2416 USB_PWR
FLAG 1712 2384 USB_PWR
FLAG 2640 2640 FET_drive
FLAG 2208 2272 0
FLAG 2672 1984 Vpos
FLAG 1872 1936 Output
FLAG 2560 2320 0
FLAG 2352 2640 Lockout
FLAG 1568 2960 0
FLAG 1568 3104 0
FLAG 1568 3248 0
FLAG 1616 2864 USB_PWR
FLAG 1616 3008 USB_PWR
FLAG 1616 3152 USB_PWR
FLAG 1472 3408 0
FLAG 1264 3408 0
FLAG 1120 3408 0
FLAG 944 3408 0
FLAG 1136 2496 USB_PWR
SYMBOL Digital\\and 2576 2592 R0
SYMATTR InstName A1
SYMATTR Value2 Vhigh=5 Ref=2.5 td=5ns
SYMBOL res -64 2576 R0
SYMATTR InstName R3
SYMATTR Value 243K
SYMBOL res -64 2448 R0
SYMATTR InstName R5
SYMATTR Value 1500K
SYMBOL nmos 64 2128 R270
WINDOW 0 57 51 VTop 2
WINDOW 3 -14 70 VLeft 2
SYMATTR InstName M2
SYMATTR Value Sir870ADP
SYMBOL nmos 304 2128 M270
WINDOW 0 56 50 VTop 2
WINDOW 3 -13 62 VLeft 2
SYMATTR InstName M4
SYMATTR Value SiR870ADP
SYMBOL res 624 2304 R0
SYMATTR InstName R11
SYMATTR Value 100K
SYMBOL res 144 2240 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R12
SYMATTR Value 22K
SYMBOL cap 144 2208 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 3.3n
SYMBOL cap 688 2096 R0
SYMATTR InstName C5
SYMATTR Value 100µ
SYMBOL voltage -176 2080 R0
WINDOW 123 24 138 Left 2
WINDOW 39 24 117 Left 2
WINDOW 3 219 -99 Right 2
SYMATTR Value PWL(0 -40 1000m -40 1.7 70 2 5 5 5 6 10 8 10 9 5)
SYMATTR InstName V2
SYMBOL res 384 2096 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R13
SYMATTR Value 0.025
SYMBOL cap 560 2560 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C6
SYMATTR Value 0.22µ
SYMBOL LTC4368-1 384 2480 R0
SYMATTR InstName U2
SYMBOL res -64 2736 R0
SYMATTR InstName R14
SYMATTR Value 56K
SYMBOL sw 992 2192 M0
WINDOW 0 -19 8 Right 2
WINDOW 3 -18 112 Right 2
SYMATTR InstName S1
SYMATTR Value my_sw
SYMBOL voltage 1104 2272 R0
WINDOW 123 24 138 Left 2
WINDOW 39 24 117 Left 2
SYMATTR InstName V6
SYMATTR Value PULSE(0 1 5.0 10n 10n 0.1 1)
SYMBOL res 1552 2512 R0
SYMATTR InstName R2
SYMATTR Value 43k
SYMBOL res 1552 2672 R0
SYMATTR InstName R4
SYMATTR Value 1k
SYMBOL res 2112 2416 R0
WINDOW 3 23 102 Left 2
SYMATTR Value 10K
SYMATTR InstName R6
SYMBOL res 2176 2416 R0
WINDOW 3 27 101 Left 2
SYMATTR Value 10K
SYMATTR InstName R7
SYMBOL cap 1968 2816 R0
WINDOW 0 42 17 Left 2
WINDOW 3 43 60 Left 2
SYMATTR InstName C1
SYMATTR Value .01µ
SYMBOL voltage -288 2416 R0
WINDOW 123 24 138 Left 2
WINDOW 39 24 117 Left 2
WINDOW 3 3 59 Right 2
SYMATTR Value 5
SYMATTR InstName V3
SYMBOL res -176 2480 R0
SYMATTR InstName R9
SYMATTR Value 29.4K
SYMBOL res -176 2304 R0
SYMATTR InstName R10
SYMATTR Value 29.4K
SYMBOL PowerProducts\\LTC2912-1 1936 2640 R0
SYMATTR InstName U1
SYMBOL e 1264 2048 R0
SYMATTR InstName E1
SYMATTR Value {factor}
SYMBOL zener 1760 2144 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value PTZ24B
SYMBOL res 1408 1968 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 10
SYMBOL voltage 2448 2672 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V4
SYMATTR Value 3.3
SYMBOL voltage 2208 2144 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V5
SYMATTR Value 15.4V
SYMBOL schottky 2224 2112 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D5
SYMATTR Value MBRS340
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky 2048 2000 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D4
SYMATTR Value MBRS340
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res 2544 2208 R0
SYMATTR InstName R15
SYMATTR Value 500
SYMBOL res 1728 2512 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R17
SYMATTR Value 10k
SYMBOL res 976 2080 R0
SYMATTR InstName R1
SYMATTR Value 100
SYMBOL res 2240 2416 R0
WINDOW 3 27 100 Left 2
SYMATTR Value 10K
SYMATTR InstName R8
SYMBOL Comparators\\LT1017 1568 2912 R0
SYMATTR InstName U3
SYMBOL Comparators\\LT1017 1568 3056 R0
SYMATTR InstName U4
SYMBOL Comparators\\LT1017 1568 3200 R0
SYMATTR InstName U5
SYMBOL voltage 1472 3280 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V1
SYMATTR Value 1.0
SYMBOL voltage 1264 3280 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V7
SYMATTR Value 0.5
SYMBOL voltage 1120 3280 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V8
SYMATTR Value 0.5
SYMBOL voltage 944 3280 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V9
SYMATTR Value 0.5
SYMBOL pnp 1024 2656 M180
SYMATTR InstName Q1
SYMBOL res 960 2592 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R18
SYMATTR Value 10k
SYMBOL res 1296 2640 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value 1k
TEXT 112 2992 Left 2 !.model my_sw sw(Vt= 0.5 Vh=-.25 Ron=0.01 Roff=100Meg)
TEXT 368 1464 Left 7 ;Protection (engineer-proofing)
TEXT 104 3024 Left 2 !.model Sload SW(Ron=1 Roff=5 Vt=.5 Vh=-.2)
TEXT 104 2936 Left 2 !.tran 25 startup
TEXT 1112 1936 Left 2 !.param factor=3
TEXT 912 1784 Left 2 ;Model of buck or boost converter\nwith some output resistance,\nparamterize "factor" accordingly.
TEXT 1792 2096 Left 2 ;"Emergency Clamp"\nIf all else fails... 24V or so,\nTransZorb or hi-power\nzener diode.
TEXT 216 1864 Left 2 ;This handles input OV/reverse protection,\nand shuts off if USB power is removed.\nLet's set the UV threshold for about 3V,\nand OC limit for 2A to start...
TEXT 1144 2296 Left 2 ;Verify OC trip with this circuit...
TEXT 1792 2328 Left 2 ;Supervisor "gracefully" disables switching\nif output voltage gets too high.
TEXT 2008 1800 Left 2 ;This diode is actually there...\nit protects the LT1995 inputs if theoutput\nrises above 15V (the LT1995 will tolerate\n24V at the inputs... as long as the supply is ~24V.)
TEXT 2248 2040 Left 2 ;This diode is the Schottky in\nthe LT3472 boost... put here\nso that Vpos behaves as it\nwould in the real circuit.
TEXT 1480 2528 VRight 2 ;22V OV\n(500mV@LTC2912)
TEXT 1208 2960 Left 2 ;From Overtemp\nComparators
TEXT 1544 3336 Left 2 ;50C Threshold
TEXT 896 3472 Left 2 ;Inductor\nTemp\nSensor
TEXT 1144 3456 Left 2 ;Load Res.\nTemp\nSensors
TEXT 392 3344 Left 2 ;TMP37 temperature sensors, 20mV/C output
TEXT 792 2736 Left 2 ;Trip LTC2912 on input fault.\nThis gives P_Prot time to ramp up\nbefore switching is enabled.
RECTANGLE Normal 1488 2416 864 1904 2
